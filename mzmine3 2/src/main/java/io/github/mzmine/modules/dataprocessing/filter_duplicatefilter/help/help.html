<!--
  ~ Copyright 2006-2021 The MZmine Development Team
  ~
  ~ This file is part of MZmine.
  ~
  ~ MZmine is free software; you can redistribute it and/or modify it under the terms of the GNU
  ~ General Public License as published by the Free Software Foundation; either version 2 of the
  ~ License, or (at your option) any later version.
  ~
  ~ MZmine is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even
  ~ the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
  ~ General Public License for more details.
  ~
  ~ You should have received a copy of the GNU General Public License along with MZmine; if not,
  ~ write to the Free Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
  ~
  -->

<html>
	<head>
		<title>Peak list filtering - Duplicate filter</title>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<link rel="stylesheet" type="text/css" href="/net/sf/mzmine/desktop/impl/helpsystem/HelpStyles.css">
    </head>

<body>

<h1>Duplicate filter</h1>

<h2>Description</h2>

<p>
Three different modes:<br>
<b>Old average</b> (the old filter): Keeps only the feature list row with the maximum average area. Checks for average m/z and RT.<br>
<b>New average</b>: Two peaks are considered duplicates when their average m/z and retention time differences are lower than
the tolerances set by the user. When two (or more) duplicates are found, a consensus row is created with the lowest row ID of all duplicates. For this consensus 
row, all <span style="background-color: #00FF00"><b>DETECTED</b></span> features are favored over <span style="background-color: #FFFF00"><b>ESTIMATED</b></span> (gap-filled) and ESTIMATED are favored over <span style="background-color: #FF0000"><b>UNKNOWN</b></span>. 
Furthermore, if there are only <span style="background-color: #FFFF00"><b>ESTIMATED</b></span> features in a raw data file, the highest is chosen.<br>
<b>Single feature</b>: Marks rows as duplicates if they share one feature within the RT and m/z tolerance in the same raw data file. Creates a consensus row.
</p>

<h4>Notes</h4>
This filter might be very helpful to eliminate misaligned feature list rows after the gap-filling process. 
As the average retention time and m/z value for two duplicates should be very close after gap-filling. A more restrictive option is to mark all rows as duplicates that share one duplicate feature. 
To use this filter, turn off the average option.


<h4>Method parameters</h4>
<dl>
<dt>Name sufix</dt>
<dd>This is the suffix to identify the new aligned peak list in Peak list frame of desktop.</dd>

<dt>Filter mode:</dt>
<dd>Old average:	Compares rows with the average m/z and RT (like the old algorithm)</dd>
<dd>New average:	Compares rows with the average m/z and RT. Creates a consensus row</dd>
<dd>Single feature: Compares rows on a raw data file basis. Marks rows as duplicates if two rows share a feature in a raw data file with the same RT and m/z (and identity/charge state)</dd>

<dt>M/Z tolerance</dt>
<dd>Maximum m/z difference between duplicate peaks.</dd>

<dt>RT tolerance</dt>
<dd>Maximum retention time difference between duplicate peaks.</dd>

<dt>Require same identification</dt>
<dd>If the checkbox is selected duplicate peaks must have the same identification.</dd>

<dt>Remove source peak list after fitering</dt>
<dd>It the checkbox is selected the source peak list will be remove and the filtered version remains.</dd>

</dl>


        <p>
        <h4>Aligned, gap-filled feature list prior and after duplicate row filter (new average).</h4>
        <img src="prior.png" name="prior">
        <img src="after.png" name="after">
        </p>
</body>
</html>
